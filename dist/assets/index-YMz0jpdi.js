import{r as k,c as se,w as K,o as Q,a as de,b as C,d as b,e as r,f as z,g as U,h as H,v as oe,i as F,j as N,F as V,k as q,l as W,t as S,n as Z,m as te,p as ue,q as re,s as he,u as G,x as ne,y as ce,z as fe}from"./vendor-CTq_6RHc.js";import{r as pe,g as me}from"./maps-zdHhRoWp.js";import{C as T,r as ge}from"./charts-Zj-L_LRF.js";(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))c(p);new MutationObserver(p=>{for(const e of p)if(e.type==="childList")for(const t of e.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&c(t)}).observe(document,{childList:!0,subtree:!0});function x(p){const e={};return p.integrity&&(e.integrity=p.integrity),p.referrerPolicy&&(e.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?e.credentials="include":p.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function c(p){if(p.ep)return;p.ep=!0;const e=x(p);fetch(p.href,e)}})();const _e="/assets/mistlogo-DSRNHEp1.svg",X=(v,f)=>{const x=v.__vccOpts||v;for(const[c,p]of f)x[c]=p;return x},ve={class:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50"},ye={class:"bg-white/90 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-50"},xe={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},be={class:"flex justify-between items-center h-16"},we={class:"md:hidden"},Ce={class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ke={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},Le={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},Me={key:0,class:"md:hidden border-t border-gray-200 py-4"},Se={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},$e={class:"mb-16 animate-fade-in"},Pe={class:"bg-white/80 backdrop-blur-sm rounded-xl shadow-lg border border-gray-100 p-6 max-w-3xl mx-auto"},Be={class:"relative"},Oe={class:"flex flex-col md:flex-row gap-3"},ze={class:"flex-1 relative"},je=["onKeydown"],Te={key:0,class:"absolute right-4 top-1/2 transform -translate-y-1/2"},Ue={key:1,class:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},Ee=["onClick","onMouseenter"],Ie={class:"font-medium"},De=["disabled"],Ae={key:0,class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ge={key:1,class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Fe={key:0,class:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg"},Ze={class:"flex items-center justify-between"},Ne={class:"flex items-center text-sm text-blue-700"},Re=["href"],He={class:"mt-1 text-xs text-blue-600 font-mono break-all"},Ve={key:0,class:"bg-red-50 border-l-4 border-red-400 text-red-700 p-6 rounded-lg mb-8 max-w-3xl mx-auto shadow-lg animate-slide-up"},qe={class:"flex items-center"},We={class:"font-medium"},Ke={key:1,class:"text-center py-20 animate-fade-in"},Qe={key:2,class:"animate-slide-up"},Xe={class:"text-center mb-12"},Ye={class:"text-gray-600 text-lg"},Je={class:"space-y-6"},et=["onClick"],tt={class:"flex items-center p-6"},it=["src","alt","onError"],st={key:1,class:"text-2xl"},ot={class:"flex-1 min-w-0"},rt={class:"flex items-start justify-between"},nt={class:"flex-1"},at={class:"text-xl font-bold text-gray-800 mb-2 group-hover:text-wikimedia-blue transition-colors duration-300"},lt={class:"text-gray-600 text-sm mb-3 line-clamp-2 leading-relaxed"},dt={class:"flex items-center space-x-3"},ut={class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700"},ht={key:3,class:"text-center py-20 animate-fade-in"},ct={__name:"CoverPage",props:{categories:{type:Array,required:!0,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["select","custom"],setup(v,{emit:f}){const x=f,c=k(!1),p=k(""),e=k([]),t=k(!1),i=k(!1),s=k(-1),n=k(""),a=k(null);let o=null;const d=w=>w&&(w.startsWith("http://")||w.startsWith("https://")),l=(w,m)=>{console.warn(`Failed to load image icon for category ${m.name}:`,w.target.src),w.target.style.display="none";const y=w.target.parentElement;if(y){y.style.background=`linear-gradient(135deg, ${m.color1||"#0645ad"} 0%, ${m.color2||"#00af89"} 100%)`;const P=document.createElement("span");P.className="text-2xl",P.textContent="ðŸ“Š",y.appendChild(P)}},u=w=>w.replace(/^Category:/i,"").replace(/\s+/g,"_"),h=se(()=>{if(!p.value.trim())return null;let w=p.value.trim();return`https://commons.wikimedia.org/wiki/Category:${u(w)}`});K(()=>new URLSearchParams(window.location.search).get("category"),w=>{if(w&&!p.value){const y=decodeURIComponent(w).replace(/^Category:/i,"");p.value=y.replace(/_/g," ")}},{immediate:!0});const _=()=>{const w=p.value.trim();if(w.length<3){t.value=!1,e.value=[];return}o&&clearTimeout(o),o=setTimeout(()=>{g(w)},300)},g=async w=>{if(!(!w||w.length<3)){i.value=!0,n.value="";try{let m=w;m.toLowerCase().startsWith("category:")||(m=`Category:${w}`);const y="https://commons.wikimedia.org/w/api.php",P=new URLSearchParams({action:"query",format:"json",origin:"*",list:"search",srnamespace:"14",srsearch:m,srlimit:"10",srprop:"size|wordcount|timestamp",formatversion:"2"}),B=await fetch(`${y}?${P}`);if(!B.ok)throw new Error(`HTTP ${B.status}: ${B.statusText}`);const E=await B.json();if(E.error)throw new Error(E.error.info||"API Error");if(E.query&&E.query.search&&E.query.search.length>0){const ae=E.query.search.map(le=>le.title);await M(ae)}else e.value=[],t.value=!1}catch(m){console.error("Category search error:",m),n.value=`Failed to search categories: ${m.message}`,e.value=[],t.value=!1}finally{i.value=!1}}},M=async w=>{try{const m="https://commons.wikimedia.org/w/api.php",y=new URLSearchParams({action:"query",format:"json",origin:"*",titles:w.join("|"),prop:"categoryinfo",formatversion:"2"}),B=await(await fetch(`${m}?${y}`)).json();B.query&&B.query.pages&&(e.value=B.query.pages.filter(E=>!E.missing),t.value=e.value.length>0,s.value=-1)}catch(m){console.error("Category info error:",m)}},$=w=>{!t.value||e.value.length===0||(s.value+=w,s.value<-1?s.value=e.value.length-1:s.value>=e.value.length&&(s.value=-1))},I=()=>{s.value>=0&&s.value<e.value.length?O(e.value[s.value]):p.value.trim()&&J()},O=w=>{p.value=w.title,t.value=!1,e.value=[],s.value=-1,ue(()=>{a.value&&a.value.focus()})},D=()=>{t.value=!1,s.value=-1},J=()=>{const w=p.value.trim();if(!w)return;const m=u(w),y={id:`custom-${Date.now()}`,name:m,slug:m,categoryName:m,description:`Custom analysis for ${w.replace(/^Category:/i,"")}`,icon:"ðŸ”",year:"Custom",color1:"#8B5CF6",color2:"#7C3AED",isCustom:!0};console.log("Creating custom category:",y),D(),x("custom",y)},ee=w=>{w.target.closest(".relative")||D()};return Q(()=>{document.addEventListener("click",ee)}),de(()=>{document.removeEventListener("click",ee),o&&clearTimeout(o)}),(w,m)=>(b(),C("div",ve,[r("header",ye,[r("div",xe,[r("div",be,[m[5]||(m[5]=U('<div class="flex items-center space-x-4" data-v-7e70ddf0><div class="flex items-center justify-center w-10 h-10 bg-gradient-to-br from-wikimedia-blue to-wikimedia-green rounded-lg" data-v-7e70ddf0><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24" data-v-7e70ddf0><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" data-v-7e70ddf0></path></svg></div><div data-v-7e70ddf0><h1 class="text-xl font-bold text-gray-900" data-v-7e70ddf0>MIST : Analytics</h1><p class="text-sm text-gray-500 hidden sm:block" data-v-7e70ddf0>Media Statistics and Analytics Dashboard for Campaigns</p></div></div><nav class="hidden md:flex items-center space-x-8" data-v-7e70ddf0><a href="#" class="text-gray-700 hover:text-wikimedia-blue font-medium transition-colors duration-200" data-v-7e70ddf0>Home</a><a href="https://w.wiki/t9" class="text-gray-700 hover:text-wikimedia-blue font-medium transition-colors duration-200" data-v-7e70ddf0>Wikimedians of Kerala</a><a href="https://gitlab.wikimedia.org/toolforge-repos/mist-tool" class="text-gray-700 hover:text-wikimedia-blue font-medium transition-colors duration-200" data-v-7e70ddf0>Gitlab</a><a href="https://commons.wikimedia.org" target="_blank" rel="noopener noreferrer" class="text-gray-700 hover:text-wikimedia-blue font-medium transition-colors duration-200" data-v-7e70ddf0>Wikimedia Commons</a></nav>',2)),r("div",we,[r("button",{onClick:m[0]||(m[0]=y=>c.value=!c.value),class:"text-gray-700 hover:text-wikimedia-blue p-2"},[(b(),C("svg",Ce,[c.value?(b(),C("path",Le)):(b(),C("path",ke))]))])])]),c.value?(b(),C("div",Me,[...m[6]||(m[6]=[U('<nav class="flex flex-col space-y-2" data-v-7e70ddf0><a href="#" class="text-gray-700 hover:text-wikimedia-blue font-medium py-2 transition-colors duration-200" data-v-7e70ddf0>Home</a><a href="https://w.wiki/t9" class="text-gray-700 hover:text-wikimedia-blue font-medium py-2 transition-colors duration-200" data-v-7e70ddf0>Wikimedians of Kerala</a><a href="https://gitlab.wikimedia.org/toolforge-repos/mist-tool" class="text-gray-700 hover:text-wikimedia-blue font-medium py-2 transition-colors duration-200" data-v-7e70ddf0>Gitlab</a><a href="https://commons.wikimedia.org" target="_blank" rel="noopener noreferrer" class="text-gray-700 hover:text-wikimedia-blue font-medium py-2 transition-colors duration-200" data-v-7e70ddf0>Wikimedia Commons</a></nav>',1)])])):z("",!0)])]),r("main",Se,[m[18]||(m[18]=U('<div class="text-center mb-4 animate-fade-in" data-v-7e70ddf0><div class="flex flex-col md:flex-row items-center justify-center gap-4 md:gap-6 mb-4" data-v-7e70ddf0><div class="flex-shrink-0" data-v-7e70ddf0><div class="w-20 h-20 md:w-24 md:h-24 lg:w-28 lg:h-28 transition-transform duration-300 hover:scale-105" data-v-7e70ddf0><img src="'+_e+'" alt="MIST Logo" class="w-full h-full object-contain drop-shadow-lg" data-v-7e70ddf0></div></div><div class="flex-1" data-v-7e70ddf0><h2 class="text-3xl md:text-4xl lg:text-5xl font-bold bg-gradient-to-r from-wikimedia-blue via-wikimedia-green to-wikimedia-blue bg-clip-text text-transparent leading-tight" data-v-7e70ddf0> Wikimedia Commons Analytics </h2></div></div><p class="text-lg md:text-xl text-gray-600 mb-1 max-w-3xl mx-auto leading-relaxed" data-v-7e70ddf0> View Statistics of a Wikimedia Commons photography campaign </p></div>',1)),r("div",$e,[r("div",Pe,[m[12]||(m[12]=r("div",{class:"text-center mb-4"},[r("h3",{class:"text-2xl font-bold text-gray-800 mb-2"},"Category of Campaign"),r("p",{class:"text-gray-600"},"Search for any Wikimedia Commons category of a campaign to analyze")],-1)),r("div",Be,[r("div",Oe,[r("div",ze,[H(r("input",{ref_key:"categoryInput",ref:a,"onUpdate:modelValue":m[1]||(m[1]=y=>p.value=y),onInput:_,onKeydown:[m[2]||(m[2]=F(N(y=>$(1),["prevent"]),["down"])),m[3]||(m[3]=F(N(y=>$(-1),["prevent"]),["up"])),F(N(I,["prevent"]),["enter"]),F(D,["escape"])],onFocus:m[4]||(m[4]=y=>t.value=p.value.length>=3),type:"text",placeholder:"Type category name:",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-wikimedia-blue focus:border-transparent transition-all duration-200 text-gray-900 placeholder-gray-500"},null,40,je),[[oe,p.value]]),i.value?(b(),C("div",Te,[...m[7]||(m[7]=[r("div",{class:"w-5 h-5 border-2 border-wikimedia-blue/20 border-t-wikimedia-blue rounded-full animate-spin"},null,-1)])])):z("",!0),t.value&&e.value.length>0?(b(),C("div",Ue,[(b(!0),C(V,null,q(e.value,(y,P)=>(b(),C("div",{key:y.title,onClick:B=>O(y),onMouseenter:B=>s.value=P,class:Z(["px-4 py-3 cursor-pointer transition-colors duration-150 border-b border-gray-100 last:border-b-0",s.value===P?"bg-wikimedia-blue text-white":"hover:bg-gray-50 text-gray-900"])},[r("div",Ie,S(y.title.replace("Category:","")),1),y.categoryinfo&&y.categoryinfo.pages?(b(),C("div",{key:0,class:Z(["text-sm mt-1",s.value===P?"text-blue-100":"text-gray-500"])},S(y.categoryinfo.pages)+" pages ",3)):z("",!0),r("div",{class:Z(["text-xs mt-1 flex items-center",s.value===P?"text-blue-200":"text-gray-400"])},[m[8]||(m[8]=r("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1)),W(" commons.wikimedia.org/wiki/"+S(y.title.replace(" ","_")),1)],2)],42,Ee))),128))])):z("",!0)]),r("button",{onClick:J,disabled:!p.value.trim()||i.value,class:"px-6 py-3 bg-gradient-to-r from-wikimedia-blue to-wikimedia-green text-white rounded-lg hover:shadow-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center font-medium"},[i.value?(b(),C("svg",Ae,[...m[9]||(m[9]=[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 818-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(b(),C("svg",Ge,[...m[10]||(m[10]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"},null,-1)])])),W(" "+S(i.value?"Searching...":"View Statistics"),1)],8,De)]),h.value?(b(),C("div",Fe,[r("div",Ze,[r("div",Ne,[m[11]||(m[11]=r("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})],-1)),r("a",{href:h.value,target:"_blank",rel:"noopener noreferrer",class:"text-blue-600 hover:text-blue-800 text-sm font-medium hover:underline transition-colors duration-200"}," View Category on Wikimedia Commons â†’ ",8,Re)])]),r("div",He," URL : "+S(h.value),1)])):z("",!0)])])]),v.error||n.value?(b(),C("div",Ve,[r("div",qe,[m[13]||(m[13]=r("svg",{class:"w-6 h-6 mr-3 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),r("span",We,S(v.error||n.value),1)])])):z("",!0),v.loading?(b(),C("div",Ke,[...m[14]||(m[14]=[U('<div class="relative inline-block" data-v-7e70ddf0><div class="w-16 h-16 border-4 border-wikimedia-blue/20 border-t-wikimedia-blue rounded-full animate-spin" data-v-7e70ddf0></div><div class="absolute inset-0 w-16 h-16 border-4 border-transparent border-r-wikimedia-green rounded-full animate-spin" style="animation-delay:-0.5s;animation-direction:reverse;" data-v-7e70ddf0></div></div><p class="mt-6 text-xl text-gray-600 font-medium" data-v-7e70ddf0>Loading categories...</p><p class="mt-2 text-gray-500" data-v-7e70ddf0>Fetching contest data from Wikimedia Commons</p>',3)])])):v.categories.length>0?(b(),C("div",Qe,[r("div",Xe,[m[15]||(m[15]=r("h3",{class:"text-3xl font-bold text-gray-800 mb-3"},"Featured Contest Categories",-1)),r("p",Ye,S(v.categories.length)+" contest"+S(v.categories.length!==1?"s":"")+" available for analysis",1)]),r("div",Je,[(b(!0),C(V,null,q(v.categories,(y,P)=>(b(),C("div",{key:y.id,onClick:B=>w.$emit("select",y),class:"group bg-white/80 backdrop-blur-sm rounded-xl shadow-md hover:shadow-xl transition-all duration-300 cursor-pointer transform hover:-translate-y-1 border border-gray-100 overflow-hidden",style:te({animationDelay:`${P*100}ms`})},[r("div",tt,[r("div",{class:"flex items-center justify-center w-16 h-16 rounded-lg mr-6 flex-shrink-0 group-hover:scale-110 transition-transform duration-300 overflow-hidden",style:te({background:d(y.icon)?"transparent":`linear-gradient(135deg, ${y.color1||"#0645ad"} 0%, ${y.color2||"#00af89"} 100%)`})},[d(y.icon)?(b(),C("img",{key:0,src:y.icon,alt:y.name,class:"w-full h-full object-cover rounded-lg",onError:B=>l(B,y)},null,40,it)):(b(),C("span",st,S(y.icon||"ðŸ“Š"),1))],4),r("div",ot,[r("div",rt,[r("div",nt,[r("h3",at,S(y.name),1),r("p",lt,S(y.description),1),r("div",dt,[r("span",ut,S(y.year||"Contest"),1),m[16]||(m[16]=r("div",{class:"flex items-center text-wikimedia-blue font-medium text-sm group-hover:translate-x-1 transition-transform duration-300"},[r("span",{class:"mr-1"},"View Analytics"),r("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})])],-1))])])])])])],12,et))),128))])])):v.loading?z("",!0):(b(),C("div",ht,[...m[17]||(m[17]=[U('<div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6" data-v-7e70ddf0><svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-7e70ddf0><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-7e70ddf0></path></svg></div><h3 class="text-xl font-semibold text-gray-700 mb-2" data-v-7e70ddf0>No Categories Available</h3><p class="text-gray-500" data-v-7e70ddf0>No contest categories found. Use the custom search above to find categories.</p>',3)])])),m[19]||(m[19]=U('<footer class="text-center mt-20 pt-12 border-t border-gray-200 animate-fade-in" data-v-7e70ddf0><div class="flex items-center justify-center space-x-8 mb-6" data-v-7e70ddf0><div class="flex items-center space-x-2 text-gray-600" data-v-7e70ddf0><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" data-v-7e70ddf0><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" data-v-7e70ddf0></path></svg><a href="https://wikitech.wikimedia.org/wiki/Portal:Toolforge" target="_blank" data-v-7e70ddf0><span class="font-medium" data-v-7e70ddf0>Wikimedia Toolforge</span></a></div><div class="flex items-center space-x-2 text-gray-600" data-v-7e70ddf0><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" data-v-7e70ddf0><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" data-v-7e70ddf0></path></svg><a href="https://hay.toolforge.org/directory/" target="_blank" data-v-7e70ddf0><span class="font-medium" data-v-7e70ddf0>Tools Directory</span></a></div><div class="flex items-center space-x-2 text-gray-600" data-v-7e70ddf0><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" data-v-7e70ddf0><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z" data-v-7e70ddf0></path></svg><a href="https://w.wiki/t9" target="_blank" data-v-7e70ddf0><span class="font-medium" data-v-7e70ddf0>Wikimedians of Kerala</span></a></div></div><p class="text-gray-500 text-sm mb-2" data-v-7e70ddf0> Powered by <a href="https://commons.wikimedia.org/" target="_blank" data-v-7e70ddf0></a><span class="font-semibold text-wikimedia-blue" data-v-7e70ddf0>Wikimedia Commons API</span> â€¢ Built with <a href="https://vuejs.org/" target="_blank" data-v-7e70ddf0><span class="font-semibold text-wikimedia-green" data-v-7e70ddf0>Vue.js</span></a> &amp; <a href="https://tailwindcss.com/" target="_blank" data-v-7e70ddf0><span class="font-semibold text-wikimedia-purple" data-v-7e70ddf0>TailwindCSS</span></a></p><p class="text-gray-400 text-xs" data-v-7e70ddf0> Analyzing media contributions from the world&#39;s largest free media repository </p></footer>',1))])]))}},ft=X(ct,[["__scopeId","data-v-7e70ddf0"]]),pt={},mt={class:"bg-white border-t border-gray-200"},gt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},_t={class:"mt-6 pt-6 border-t border-gray-200 flex flex-col md:flex-row md:items-center md:justify-between gap-4"},vt={class:"text-xs text-gray-500"};function yt(v,f){return b(),C("footer",mt,[r("div",gt,[f[1]||(f[1]=U('<div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-lg bg-gradient-to-br from-wikimedia-blue to-wikimedia-green flex items-center justify-center"><svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"></path></svg></div><div><p class="text-sm font-semibold text-gray-900">MIST by <a href="https://w.wiki/tN" target="_blank">Ranjithsiji</a></p><p class="text-xs text-gray-500">Media Statistics and Analytics Dashboard for Wikimedia Commons Campaigns</p></div></div><div class="grid grid-cols-2 sm:grid-cols-4 gap-2 text-sm"><a href="#" class="text-gray-600 hover:text-wikimedia-blue">About</a><a href="#" class="text-gray-600 hover:text-wikimedia-blue">Documentation</a><a href="https://commons.wikimedia.org" target="_blank" rel="noopener noreferrer" class="text-gray-600 hover:text-wikimedia-blue">Wikimedia Commons</a><a href="https://github.com/ranjithsiji/mist-commons" target="_blank" rel="noopener noreferrer" class="text-gray-600 hover:text-wikimedia-blue">GitHub</a></div></div>',1)),r("div",_t,[r("p",vt,"Â© "+S(new Date().getFullYear())+" MIST. Built with Vue.js and TailwindCSS.",1),f[0]||(f[0]=r("div",{class:"flex items-center gap-4 text-xs text-gray-500"},[r("span",null,[r("a",{href:"https://gitlab.wikimedia.org/toolforge-repos/mist-tools",target:"_blank"}," Source Code ")]),r("span",null,[r("a",{href:"https://github.com/ranjithsiji/mist-commons/blob/main/LICENSE",target:"_blank"},"License")]),r("span",null,[r("a",{href:"https://w.wiki/t9",target:"_blank"},"Wikimedians of Kerala User Group")])],-1))])])])}const xt=X(pt,[["render",yt]]),bt={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 mb-8"},wt={class:"bg-white rounded-lg shadow p-6"},Ct={class:"flex items-center justify-between"},kt={class:"text-3xl font-bold text-blue-600"},Lt={class:"bg-white rounded-lg shadow p-6"},Mt={class:"flex items-center justify-between"},St={class:"text-3xl font-bold text-green-600"},$t={class:"bg-white rounded-lg shadow p-6"},Pt={class:"flex items-center justify-between"},Bt={class:"text-3xl font-bold text-purple-600"},Ot={class:"bg-white rounded-lg shadow p-6"},zt={class:"flex items-center justify-between"},jt={class:"text-2xl font-bold text-orange-600"},Tt={class:"bg-white rounded-lg shadow p-6"},Ut={class:"flex items-center justify-between"},Et={class:"text-2xl font-bold text-pink-600"},It={class:"bg-white rounded-lg shadow p-6"},Dt={class:"flex items-center justify-between"},At={class:"text-3xl font-bold text-cyan-600"},Gt={__name:"StatsCards",props:{stats:{type:Object,required:!0}},setup(v){const f=x=>{if(!x||x===0)return"0 Bytes";const c=1024,p=["Bytes","KB","MB","GB"],e=Math.floor(Math.log(x)/Math.log(c));return Math.round(x/Math.pow(c,e)*100)/100+" "+p[e]};return(x,c)=>(b(),C("div",bt,[r("div",wt,[r("div",Ct,[r("div",null,[c[0]||(c[0]=r("p",{class:"text-gray-600 text-md"},"Contributors",-1)),r("p",kt,S(v.stats.uniqueUsers),1)]),c[1]||(c[1]=r("svg",{class:"w-10 h-10 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1))])]),r("div",Lt,[r("div",Mt,[r("div",null,[c[2]||(c[2]=r("p",{class:"text-gray-500 text-sm"},"Total Files",-1)),r("p",St,S(v.stats.totalFiles),1)]),c[3]||(c[3]=r("svg",{class:"w-10 h-10 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1))])]),r("div",$t,[r("div",Pt,[r("div",null,[c[4]||(c[4]=r("p",{class:"text-gray-500 text-sm"},"Active Days",-1)),r("p",Bt,S(v.stats.uniqueDates),1)]),c[5]||(c[5]=r("svg",{class:"w-10 h-10 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1))])]),r("div",Ot,[r("div",zt,[r("div",null,[c[6]||(c[6]=r("p",{class:"text-gray-500 text-sm"},"Total Size",-1)),r("p",jt,S(f(v.stats.totalSize)),1)]),c[7]||(c[7]=r("svg",{class:"w-10 h-10 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"})],-1))])]),r("div",Tt,[r("div",Ut,[r("div",null,[c[8]||(c[8]=r("p",{class:"text-gray-500 text-sm"},"Avg File Size",-1)),r("p",Et,S(f(v.stats.avgFileSize)),1)]),c[9]||(c[9]=r("svg",{class:"w-10 h-10 text-pink-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})],-1))])]),r("div",It,[r("div",Dt,[r("div",null,[c[10]||(c[10]=r("p",{class:"text-gray-500 text-sm"},"Geotagged",-1)),r("p",At,S(v.stats.geotaggedFiles),1)]),c[11]||(c[11]=r("svg",{class:"w-10 h-10 text-cyan-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1))])])]))}};var Ft=pe();const j=me(Ft);var A={exports:{}},Zt=A.exports,ie;function Nt(){return ie||(ie=1,(function(v,f){(function(x,c){c(f)})(Zt,function(x){var c=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(e){L.Util.setOptions(this,e),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var t=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,t?this._withAnimation:this._noAnimation),this._markerCluster=t?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(e){if(e instanceof L.LayerGroup)return this.addLayers([e]);if(!e.getLatLng)return this._nonPointGroup.addLayer(e),this.fire("layeradd",{layer:e}),this;if(!this._map)return this._needsClustering.push(e),this.fire("layeradd",{layer:e}),this;if(this.hasLayer(e))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(e,this._maxZoom),this.fire("layeradd",{layer:e}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var t=e,i=this._zoom;if(e.__parent)for(;t.__parent._zoom>=i;)t=t.__parent;return this._currentShownBounds.contains(t.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(e,t):this._animationAddLayerNonAnimated(e,t)),this},removeLayer:function(e){return e instanceof L.LayerGroup?this.removeLayers([e]):e.getLatLng?this._map?e.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(e)),this._removeLayer(e,!0),this.fire("layerremove",{layer:e}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),e.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(e)&&(this._featureGroup.removeLayer(e),e.clusterShow&&e.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,e)&&this.hasLayer(e)&&this._needsRemoving.push({layer:e,latlng:e._latlng}),this.fire("layerremove",{layer:e}),this):(this._nonPointGroup.removeLayer(e),this.fire("layerremove",{layer:e}),this)},addLayers:function(e,t){if(!L.Util.isArray(e))return this.addLayer(e);var i=this._featureGroup,s=this._nonPointGroup,n=this.options.chunkedLoading,a=this.options.chunkInterval,o=this.options.chunkProgress,d=e.length,l=0,u=!0,h;if(this._map){var _=new Date().getTime(),g=L.bind(function(){var $=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();l<d;l++){if(n&&l%200===0){var I=new Date().getTime()-$;if(I>a)break}if(h=e[l],h instanceof L.LayerGroup){u&&(e=e.slice(),u=!1),this._extractNonGroupLayers(h,e),d=e.length;continue}if(!h.getLatLng){s.addLayer(h),t||this.fire("layeradd",{layer:h});continue}if(!this.hasLayer(h)&&(this._addLayer(h,this._maxZoom),t||this.fire("layeradd",{layer:h}),h.__parent&&h.__parent.getChildCount()===2)){var O=h.__parent.getAllChildMarkers(),D=O[0]===h?O[1]:O[0];i.removeLayer(D)}}o&&o(l,d,new Date().getTime()-_),l===d?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(g,this.options.chunkDelay)},this);g()}else for(var M=this._needsClustering;l<d;l++){if(h=e[l],h instanceof L.LayerGroup){u&&(e=e.slice(),u=!1),this._extractNonGroupLayers(h,e),d=e.length;continue}if(!h.getLatLng){s.addLayer(h);continue}this.hasLayer(h)||M.push(h)}return this},removeLayers:function(e){var t,i,s=e.length,n=this._featureGroup,a=this._nonPointGroup,o=!0;if(!this._map){for(t=0;t<s;t++){if(i=e[t],i instanceof L.LayerGroup){o&&(e=e.slice(),o=!1),this._extractNonGroupLayers(i,e),s=e.length;continue}this._arraySplice(this._needsClustering,i),a.removeLayer(i),this.hasLayer(i)&&this._needsRemoving.push({layer:i,latlng:i._latlng}),this.fire("layerremove",{layer:i})}return this}if(this._unspiderfy){this._unspiderfy();var d=e.slice(),l=s;for(t=0;t<l;t++){if(i=d[t],i instanceof L.LayerGroup){this._extractNonGroupLayers(i,d),l=d.length;continue}this._unspiderfyLayer(i)}}for(t=0;t<s;t++){if(i=e[t],i instanceof L.LayerGroup){o&&(e=e.slice(),o=!1),this._extractNonGroupLayers(i,e),s=e.length;continue}if(!i.__parent){a.removeLayer(i),this.fire("layerremove",{layer:i});continue}this._removeLayer(i,!0,!0),this.fire("layerremove",{layer:i}),n.hasLayer(i)&&(n.removeLayer(i),i.clusterShow&&i.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(e){e.off(this._childMarkerEventHandlers,this),delete e.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var e=new L.LatLngBounds;this._topClusterLevel&&e.extend(this._topClusterLevel._bounds);for(var t=this._needsClustering.length-1;t>=0;t--)e.extend(this._needsClustering[t].getLatLng());return e.extend(this._nonPointGroup.getBounds()),e},eachLayer:function(e,t){var i=this._needsClustering.slice(),s=this._needsRemoving,n,a,o;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(i),a=i.length-1;a>=0;a--){for(n=!0,o=s.length-1;o>=0;o--)if(s[o].layer===i[a]){n=!1;break}n&&e.call(t,i[a])}this._nonPointGroup.eachLayer(e,t)},getLayers:function(){var e=[];return this.eachLayer(function(t){e.push(t)}),e},getLayer:function(e){var t=null;return e=parseInt(e,10),this.eachLayer(function(i){L.stamp(i)===e&&(t=i)}),t},hasLayer:function(e){if(!e)return!1;var t,i=this._needsClustering;for(t=i.length-1;t>=0;t--)if(i[t]===e)return!0;for(i=this._needsRemoving,t=i.length-1;t>=0;t--)if(i[t].layer===e)return!1;return!!(e.__parent&&e.__parent._group===this)||this._nonPointGroup.hasLayer(e)},zoomToShowLayer:function(e,t){var i=this._map;typeof t!="function"&&(t=function(){});var s=function(){(i.hasLayer(e)||i.hasLayer(e.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",s,this),this.off("animationend",s,this),i.hasLayer(e)?t():e.__parent._icon&&(this.once("spiderfied",t,this),e.__parent.spiderfy()))};e._icon&&this._map.getBounds().contains(e.getLatLng())?t():e.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",s,this),this._map.panTo(e.getLatLng())):(this._map.on("moveend",s,this),this.on("animationend",s,this),e.__parent.zoomToBounds())},onAdd:function(e){this._map=e;var t,i,s;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(e),this._nonPointGroup.addTo(e),this._gridClusters||this._generateInitialClusters(),this._maxLat=e.options.crs.projection.MAX_LATITUDE,t=0,i=this._needsRemoving.length;t<i;t++)s=this._needsRemoving[t],s.newlatlng=s.layer._latlng,s.layer._latlng=s.latlng;for(t=0,i=this._needsRemoving.length;t<i;t++)s=this._needsRemoving[t],this._removeLayer(s.layer,!0),s.layer._latlng=s.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),i=this._needsClustering,this._needsClustering=[],this.addLayers(i,!0)},onRemove:function(e){e.off("zoomend",this._zoomEnd,this),e.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(e){for(var t=e;t&&!t._icon;)t=t.__parent;return t||null},_arraySplice:function(e,t){for(var i=e.length-1;i>=0;i--)if(e[i]===t)return e.splice(i,1),!0},_removeFromGridUnclustered:function(e,t){for(var i=this._map,s=this._gridUnclustered,n=Math.floor(this._map.getMinZoom());t>=n&&s[t].removeObject(e,i.project(e.getLatLng(),t));t--);},_childMarkerDragStart:function(e){e.target.__dragStart=e.target._latlng},_childMarkerMoved:function(e){if(!this._ignoreMove&&!e.target.__dragStart){var t=e.target._popup&&e.target._popup.isOpen();this._moveChild(e.target,e.oldLatLng,e.latlng),t&&e.target.openPopup()}},_moveChild:function(e,t,i){e._latlng=t,this.removeLayer(e),e._latlng=i,this.addLayer(e)},_childMarkerDragEnd:function(e){var t=e.target.__dragStart;delete e.target.__dragStart,t&&this._moveChild(e.target,t,e.target._latlng)},_removeLayer:function(e,t,i){var s=this._gridClusters,n=this._gridUnclustered,a=this._featureGroup,o=this._map,d=Math.floor(this._map.getMinZoom());t&&this._removeFromGridUnclustered(e,this._maxZoom);var l=e.__parent,u=l._markers,h;for(this._arraySplice(u,e);l&&(l._childCount--,l._boundsNeedUpdate=!0,!(l._zoom<d));)t&&l._childCount<=1?(h=l._markers[0]===e?l._markers[1]:l._markers[0],s[l._zoom].removeObject(l,o.project(l._cLatLng,l._zoom)),n[l._zoom].addObject(h,o.project(h.getLatLng(),l._zoom)),this._arraySplice(l.__parent._childClusters,l),l.__parent._markers.push(h),h.__parent=l.__parent,l._icon&&(a.removeLayer(l),i||a.addLayer(h))):l._iconNeedsUpdate=!0,l=l.__parent;delete e.__parent},_isOrIsParent:function(e,t){for(;t;){if(e===t)return!0;t=t.parentNode}return!1},fire:function(e,t,i){if(t&&t.layer instanceof L.MarkerCluster){if(t.originalEvent&&this._isOrIsParent(t.layer._icon,t.originalEvent.relatedTarget))return;e="cluster"+e}L.FeatureGroup.prototype.fire.call(this,e,t,i)},listens:function(e,t){return L.FeatureGroup.prototype.listens.call(this,e,t)||L.FeatureGroup.prototype.listens.call(this,"cluster"+e,t)},_defaultIconCreateFunction:function(e){var t=e.getChildCount(),i=" marker-cluster-";return t<10?i+="small":t<100?i+="medium":i+="large",new L.DivIcon({html:"<div><span>"+t+"</span></div>",className:"marker-cluster"+i,iconSize:new L.Point(40,40)})},_bindEvents:function(){var e=this._map,t=this.options.spiderfyOnMaxZoom,i=this.options.showCoverageOnHover,s=this.options.zoomToBoundsOnClick,n=this.options.spiderfyOnEveryZoom;(t||s||n)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),i&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),e.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(e){var t=e.layer,i=t;if(!(e.type==="clusterkeypress"&&e.originalEvent&&e.originalEvent.keyCode!==13)){for(;i._childClusters.length===1;)i=i._childClusters[0];i._zoom===this._maxZoom&&i._childCount===t._childCount&&this.options.spiderfyOnMaxZoom?t.spiderfy():this.options.zoomToBoundsOnClick&&t.zoomToBounds(),this.options.spiderfyOnEveryZoom&&t.spiderfy(),e.originalEvent&&e.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(e){var t=this._map;this._inZoomAnimation||(this._shownPolygon&&t.removeLayer(this._shownPolygon),e.layer.getChildCount()>2&&e.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(e.layer.getConvexHull(),this.options.polygonOptions),t.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var e=this.options.spiderfyOnMaxZoom,t=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,s=this.options.spiderfyOnEveryZoom,n=this._map;(e||i||s)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),t&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),n.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var e=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),e),this._currentShownBounds=e}},_generateInitialClusters:function(){var e=Math.ceil(this._map.getMaxZoom()),t=Math.floor(this._map.getMinZoom()),i=this.options.maxClusterRadius,s=i;typeof i!="function"&&(s=function(){return i}),this.options.disableClusteringAtZoom!==null&&(e=this.options.disableClusteringAtZoom-1),this._maxZoom=e,this._gridClusters={},this._gridUnclustered={};for(var n=e;n>=t;n--)this._gridClusters[n]=new L.DistanceGrid(s(n)),this._gridUnclustered[n]=new L.DistanceGrid(s(n));this._topClusterLevel=new this._markerCluster(this,t-1)},_addLayer:function(e,t){var i=this._gridClusters,s=this._gridUnclustered,n=Math.floor(this._map.getMinZoom()),a,o;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(e),e.on(this._childMarkerEventHandlers,this);t>=n;t--){a=this._map.project(e.getLatLng(),t);var d=i[t].getNearObject(a);if(d){d._addChild(e),e.__parent=d;return}if(d=s[t].getNearObject(a),d){var l=d.__parent;l&&this._removeLayer(d,!1);var u=new this._markerCluster(this,t,d,e);i[t].addObject(u,this._map.project(u._cLatLng,t)),d.__parent=u,e.__parent=u;var h=u;for(o=t-1;o>l._zoom;o--)h=new this._markerCluster(this,o,h),i[o].addObject(h,this._map.project(d.getLatLng(),o));l._addChild(h),this._removeFromGridUnclustered(d,t);return}s[t].addObject(e,a)}this._topClusterLevel._addChild(e),e.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(e){e instanceof L.MarkerCluster&&e._iconNeedsUpdate&&e._updateIcon()})},_enqueue:function(e){this._queue.push(e),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var e=0;e<this._queue.length;e++)this._queue[e].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var e=Math.round(this._map._zoom);this._processQueue(),this._zoom<e&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,e)):this._zoom>e?(this._animationStart(),this._animationZoomOut(this._zoom,e)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(e){var t=this._maxLat;return t!==void 0&&(e.getNorth()>=t&&(e._northEast.lat=1/0),e.getSouth()<=-t&&(e._southWest.lat=-1/0)),e},_animationAddLayerNonAnimated:function(e,t){if(t===e)this._featureGroup.addLayer(e);else if(t._childCount===2){t._addToMap();var i=t.getAllChildMarkers();this._featureGroup.removeLayer(i[0]),this._featureGroup.removeLayer(i[1])}else t._updateIcon()},_extractNonGroupLayers:function(e,t){var i=e.getLayers(),s=0,n;for(t=t||[];s<i.length;s++){if(n=i[s],n instanceof L.LayerGroup){this._extractNonGroupLayers(n,t);continue}t.push(n)}return t},_overrideMarkerIcon:function(e){var t=e.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[e]}});return t}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(e,t){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),e),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(e,t){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),e),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(e,t){this._animationAddLayerNonAnimated(e,t)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(e,t){var i=this._getExpandedVisibleBounds(),s=this._featureGroup,n=Math.floor(this._map.getMinZoom()),a;this._ignoreMove=!0,this._topClusterLevel._recursively(i,e,n,function(o){var d=o._latlng,l=o._markers,u;for(i.contains(d)||(d=null),o._isSingleParent()&&e+1===t?(s.removeLayer(o),o._recursivelyAddChildrenToMap(null,t,i)):(o.clusterHide(),o._recursivelyAddChildrenToMap(d,t,i)),a=l.length-1;a>=0;a--)u=l[a],i.contains(u._latlng)||s.removeLayer(u)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(i,t),s.eachLayer(function(o){!(o instanceof L.MarkerCluster)&&o._icon&&o.clusterShow()}),this._topClusterLevel._recursively(i,e,t,function(o){o._recursivelyRestoreChildPositions(t)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(i,e,n,function(o){s.removeLayer(o),o.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(e,t){this._animationZoomOutSingle(this._topClusterLevel,e-1,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),e,this._getExpandedVisibleBounds())},_animationAddLayer:function(e,t){var i=this,s=this._featureGroup;s.addLayer(e),t!==e&&(t._childCount>2?(t._updateIcon(),this._forceLayout(),this._animationStart(),e._setPos(this._map.latLngToLayerPoint(t.getLatLng())),e.clusterHide(),this._enqueue(function(){s.removeLayer(e),e.clusterShow(),i._animationEnd()})):(this._forceLayout(),i._animationStart(),i._animationZoomOutSingle(t,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(e,t,i){var s=this._getExpandedVisibleBounds(),n=Math.floor(this._map.getMinZoom());e._recursivelyAnimateChildrenInAndAddSelfToMap(s,n,t+1,i);var a=this;this._forceLayout(),e._recursivelyBecomeVisible(s,i),this._enqueue(function(){if(e._childCount===1){var o=e._markers[0];this._ignoreMove=!0,o.setLatLng(o.getLatLng()),this._ignoreMove=!1,o.clusterShow&&o.clusterShow()}else e._recursively(s,i,n,function(d){d._recursivelyRemoveChildrenFromMap(s,n,t+1)});a._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(e){return new L.MarkerClusterGroup(e)};var p=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(e,t,i,s){L.Marker.prototype.initialize.call(this,i?i._cLatLng||i.getLatLng():new L.LatLng(0,0),{icon:this,pane:e.options.clusterPane}),this._group=e,this._zoom=t,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,i&&this._addChild(i),s&&this._addChild(s)},getAllChildMarkers:function(e,t){e=e||[];for(var i=this._childClusters.length-1;i>=0;i--)this._childClusters[i].getAllChildMarkers(e,t);for(var s=this._markers.length-1;s>=0;s--)t&&this._markers[s].__dragStart||e.push(this._markers[s]);return e},getChildCount:function(){return this._childCount},zoomToBounds:function(e){for(var t=this._childClusters.slice(),i=this._group._map,s=i.getBoundsZoom(this._bounds),n=this._zoom+1,a=i.getZoom(),o;t.length>0&&s>n;){n++;var d=[];for(o=0;o<t.length;o++)d=d.concat(t[o]._childClusters);t=d}s>n?this._group._map.setView(this._latlng,n):s<=a?this._group._map.setView(this._latlng,a+1):this._group._map.fitBounds(this._bounds,e)},getBounds:function(){var e=new L.LatLngBounds;return e.extend(this._bounds),e},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(e,t){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(e),e instanceof L.MarkerCluster?(t||(this._childClusters.push(e),e.__parent=this),this._childCount+=e._childCount):(t||this._markers.push(e),this._childCount++),this.__parent&&this.__parent._addChild(e,!0)},_setClusterCenter:function(e){this._cLatLng||(this._cLatLng=e._cLatLng||e._latlng)},_resetBounds:function(){var e=this._bounds;e._southWest&&(e._southWest.lat=1/0,e._southWest.lng=1/0),e._northEast&&(e._northEast.lat=-1/0,e._northEast.lng=-1/0)},_recalculateBounds:function(){var e=this._markers,t=this._childClusters,i=0,s=0,n=this._childCount,a,o,d,l;if(n!==0){for(this._resetBounds(),a=0;a<e.length;a++)d=e[a]._latlng,this._bounds.extend(d),i+=d.lat,s+=d.lng;for(a=0;a<t.length;a++)o=t[a],o._boundsNeedUpdate&&o._recalculateBounds(),this._bounds.extend(o._bounds),d=o._wLatLng,l=o._childCount,i+=d.lat*l,s+=d.lng*l;this._latlng=this._wLatLng=new L.LatLng(i/n,s/n),this._boundsNeedUpdate=!1}},_addToMap:function(e){e&&(this._backupLatlng=this._latlng,this.setLatLng(e)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(e,t,i){this._recursively(e,this._group._map.getMinZoom(),i-1,function(s){var n=s._markers,a,o;for(a=n.length-1;a>=0;a--)o=n[a],o._icon&&(o._setPos(t),o.clusterHide())},function(s){var n=s._childClusters,a,o;for(a=n.length-1;a>=0;a--)o=n[a],o._icon&&(o._setPos(t),o.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(e,t,i,s){this._recursively(e,s,t,function(n){n._recursivelyAnimateChildrenIn(e,n._group._map.latLngToLayerPoint(n.getLatLng()).round(),i),n._isSingleParent()&&i-1===s?(n.clusterShow(),n._recursivelyRemoveChildrenFromMap(e,t,i)):n.clusterHide(),n._addToMap()})},_recursivelyBecomeVisible:function(e,t){this._recursively(e,this._group._map.getMinZoom(),t,null,function(i){i.clusterShow()})},_recursivelyAddChildrenToMap:function(e,t,i){this._recursively(i,this._group._map.getMinZoom()-1,t,function(s){if(t!==s._zoom)for(var n=s._markers.length-1;n>=0;n--){var a=s._markers[n];i.contains(a._latlng)&&(e&&(a._backupLatlng=a.getLatLng(),a.setLatLng(e),a.clusterHide&&a.clusterHide()),s._group._featureGroup.addLayer(a))}},function(s){s._addToMap(e)})},_recursivelyRestoreChildPositions:function(e){for(var t=this._markers.length-1;t>=0;t--){var i=this._markers[t];i._backupLatlng&&(i.setLatLng(i._backupLatlng),delete i._backupLatlng)}if(e-1===this._zoom)for(var s=this._childClusters.length-1;s>=0;s--)this._childClusters[s]._restorePosition();else for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n]._recursivelyRestoreChildPositions(e)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(e,t,i,s){var n,a;this._recursively(e,t-1,i-1,function(o){for(a=o._markers.length-1;a>=0;a--)n=o._markers[a],(!s||!s.contains(n._latlng))&&(o._group._featureGroup.removeLayer(n),n.clusterShow&&n.clusterShow())},function(o){for(a=o._childClusters.length-1;a>=0;a--)n=o._childClusters[a],(!s||!s.contains(n._latlng))&&(o._group._featureGroup.removeLayer(n),n.clusterShow&&n.clusterShow())})},_recursively:function(e,t,i,s,n){var a=this._childClusters,o=this._zoom,d,l;if(t<=o&&(s&&s(this),n&&o===i&&n(this)),o<t||o<i)for(d=a.length-1;d>=0;d--)l=a[d],l._boundsNeedUpdate&&l._recalculateBounds(),e.intersects(l._bounds)&&l._recursively(e,t,i,s,n)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var e=this.options.opacity;return this.setOpacity(0),this.options.opacity=e,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(e){this._cellSize=e,this._sqCellSize=e*e,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(e,t){var i=this._getCoord(t.x),s=this._getCoord(t.y),n=this._grid,a=n[s]=n[s]||{},o=a[i]=a[i]||[],d=L.Util.stamp(e);this._objectPoint[d]=t,o.push(e)},updateObject:function(e,t){this.removeObject(e),this.addObject(e,t)},removeObject:function(e,t){var i=this._getCoord(t.x),s=this._getCoord(t.y),n=this._grid,a=n[s]=n[s]||{},o=a[i]=a[i]||[],d,l;for(delete this._objectPoint[L.Util.stamp(e)],d=0,l=o.length;d<l;d++)if(o[d]===e)return o.splice(d,1),l===1&&delete a[i],!0},eachObject:function(e,t){var i,s,n,a,o,d,l,u=this._grid;for(i in u){o=u[i];for(s in o)for(d=o[s],n=0,a=d.length;n<a;n++)l=e.call(t,d[n]),l&&(n--,a--)}},getNearObject:function(e){var t=this._getCoord(e.x),i=this._getCoord(e.y),s,n,a,o,d,l,u,h,_=this._objectPoint,g=this._sqCellSize,M=null;for(s=i-1;s<=i+1;s++)if(o=this._grid[s],o){for(n=t-1;n<=t+1;n++)if(d=o[n],d)for(a=0,l=d.length;a<l;a++)u=d[a],h=this._sqDist(_[L.Util.stamp(u)],e),(h<g||h<=g&&M===null)&&(g=h,M=u)}return M},_getCoord:function(e){var t=Math.floor(e/this._cellSize);return isFinite(t)?t:e},_sqDist:function(e,t){var i=t.x-e.x,s=t.y-e.y;return i*i+s*s}},(function(){L.QuickHull={getDistant:function(e,t){var i=t[1].lat-t[0].lat,s=t[0].lng-t[1].lng;return s*(e.lat-t[0].lat)+i*(e.lng-t[0].lng)},findMostDistantPointFromBaseLine:function(e,t){var i=0,s=null,n=[],a,o,d;for(a=t.length-1;a>=0;a--){if(o=t[a],d=this.getDistant(o,e),d>0)n.push(o);else continue;d>i&&(i=d,s=o)}return{maxPoint:s,newPoints:n}},buildConvexHull:function(e,t){var i=[],s=this.findMostDistantPointFromBaseLine(e,t);return s.maxPoint?(i=i.concat(this.buildConvexHull([e[0],s.maxPoint],s.newPoints)),i=i.concat(this.buildConvexHull([s.maxPoint,e[1]],s.newPoints)),i):[e[0]]},getConvexHull:function(e){var t=!1,i=!1,s=!1,n=!1,a=null,o=null,d=null,l=null,u=null,h=null,_;for(_=e.length-1;_>=0;_--){var g=e[_];(t===!1||g.lat>t)&&(a=g,t=g.lat),(i===!1||g.lat<i)&&(o=g,i=g.lat),(s===!1||g.lng>s)&&(d=g,s=g.lng),(n===!1||g.lng<n)&&(l=g,n=g.lng)}i!==t?(h=o,u=a):(h=l,u=d);var M=[].concat(this.buildConvexHull([h,u],e),this.buildConvexHull([u,h],e));return M}}})(),L.MarkerCluster.include({getConvexHull:function(){var e=this.getAllChildMarkers(),t=[],i,s;for(s=e.length-1;s>=0;s--)i=e[s].getLatLng(),t.push(i);return L.QuickHull.getConvexHull(t)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var e=this.getAllChildMarkers(null,!0),t=this._group,i=t._map,s=i.latLngToLayerPoint(this._latlng),n;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?n=this._group.options.spiderfyShapePositions(e.length,s):e.length>=this._circleSpiralSwitchover?n=this._generatePointsSpiral(e.length,s):(s.y+=10,n=this._generatePointsCircle(e.length,s)),this._animationSpiderfy(e,n)}},unspiderfy:function(e){this._group._inZoomAnimation||(this._animationUnspiderfy(e),this._group._spiderfied=null)},_generatePointsCircle:function(e,t){var i=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+e),s=i/this._2PI,n=this._2PI/e,a=[],o,d;for(s=Math.max(s,35),a.length=e,o=0;o<e;o++)d=this._circleStartAngle+o*n,a[o]=new L.Point(t.x+s*Math.cos(d),t.y+s*Math.sin(d))._round();return a},_generatePointsSpiral:function(e,t){var i=this._group.options.spiderfyDistanceMultiplier,s=i*this._spiralLengthStart,n=i*this._spiralFootSeparation,a=i*this._spiralLengthFactor*this._2PI,o=0,d=[],l;for(d.length=e,l=e;l>=0;l--)l<e&&(d[l]=new L.Point(t.x+s*Math.cos(o),t.y+s*Math.sin(o))._round()),o+=n/s+l*5e-4,s+=a/o;return d},_noanimationUnspiderfy:function(){var e=this._group,t=e._map,i=e._featureGroup,s=this.getAllChildMarkers(null,!0),n,a;for(e._ignoreMove=!0,this.setOpacity(1),a=s.length-1;a>=0;a--)n=s[a],i.removeLayer(n),n._preSpiderfyLatlng&&(n.setLatLng(n._preSpiderfyLatlng),delete n._preSpiderfyLatlng),n.setZIndexOffset&&n.setZIndexOffset(0),n._spiderLeg&&(t.removeLayer(n._spiderLeg),delete n._spiderLeg);e.fire("unspiderfied",{cluster:this,markers:s}),e._ignoreMove=!1,e._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(e,t){var i=this._group,s=i._map,n=i._featureGroup,a=this._group.options.spiderLegPolylineOptions,o,d,l,u;for(i._ignoreMove=!0,o=0;o<e.length;o++)u=s.layerPointToLatLng(t[o]),d=e[o],l=new L.Polyline([this._latlng,u],a),s.addLayer(l),d._spiderLeg=l,d._preSpiderfyLatlng=d._latlng,d.setLatLng(u),d.setZIndexOffset&&d.setZIndexOffset(1e6),n.addLayer(d);this.setOpacity(.3),i._ignoreMove=!1,i.fire("spiderfied",{cluster:this,markers:e})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(e,t){var i=this,s=this._group,n=s._map,a=s._featureGroup,o=this._latlng,d=n.latLngToLayerPoint(o),l=L.Path.SVG,u=L.extend({},this._group.options.spiderLegPolylineOptions),h=u.opacity,_,g,M,$,I,O;for(h===void 0&&(h=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),l?(u.opacity=0,u.className=(u.className||"")+" leaflet-cluster-spider-leg"):u.opacity=h,s._ignoreMove=!0,_=0;_<e.length;_++)g=e[_],O=n.layerPointToLatLng(t[_]),M=new L.Polyline([o,O],u),n.addLayer(M),g._spiderLeg=M,l&&($=M._path,I=$.getTotalLength()+.1,$.style.strokeDasharray=I,$.style.strokeDashoffset=I),g.setZIndexOffset&&g.setZIndexOffset(1e6),g.clusterHide&&g.clusterHide(),a.addLayer(g),g._setPos&&g._setPos(d);for(s._forceLayout(),s._animationStart(),_=e.length-1;_>=0;_--)O=n.layerPointToLatLng(t[_]),g=e[_],g._preSpiderfyLatlng=g._latlng,g.setLatLng(O),g.clusterShow&&g.clusterShow(),l&&(M=g._spiderLeg,$=M._path,$.style.strokeDashoffset=0,M.setStyle({opacity:h}));this.setOpacity(.3),s._ignoreMove=!1,setTimeout(function(){s._animationEnd(),s.fire("spiderfied",{cluster:i,markers:e})},200)},_animationUnspiderfy:function(e){var t=this,i=this._group,s=i._map,n=i._featureGroup,a=e?s._latLngToNewLayerPoint(this._latlng,e.zoom,e.center):s.latLngToLayerPoint(this._latlng),o=this.getAllChildMarkers(null,!0),d=L.Path.SVG,l,u,h,_,g,M;for(i._ignoreMove=!0,i._animationStart(),this.setOpacity(1),u=o.length-1;u>=0;u--)l=o[u],l._preSpiderfyLatlng&&(l.closePopup(),l.setLatLng(l._preSpiderfyLatlng),delete l._preSpiderfyLatlng,M=!0,l._setPos&&(l._setPos(a),M=!1),l.clusterHide&&(l.clusterHide(),M=!1),M&&n.removeLayer(l),d&&(h=l._spiderLeg,_=h._path,g=_.getTotalLength()+.1,_.style.strokeDashoffset=g,h.setStyle({opacity:0})));i._ignoreMove=!1,setTimeout(function(){var $=0;for(u=o.length-1;u>=0;u--)l=o[u],l._spiderLeg&&$++;for(u=o.length-1;u>=0;u--)l=o[u],l._spiderLeg&&(l.clusterShow&&l.clusterShow(),l.setZIndexOffset&&l.setZIndexOffset(0),$>1&&n.removeLayer(l),s.removeLayer(l._spiderLeg),delete l._spiderLeg);i._animationEnd(),i.fire("unspiderfied",{cluster:t,markers:o})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(e){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(e))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(e){this._spiderfied&&this._spiderfied.unspiderfy(e)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(e){e._spiderLeg&&(this._featureGroup.removeLayer(e),e.clusterShow&&e.clusterShow(),e.setZIndexOffset&&e.setZIndexOffset(0),this._map.removeLayer(e._spiderLeg),delete e._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(e){return e?e instanceof L.MarkerClusterGroup?e=e._topClusterLevel.getAllChildMarkers():e instanceof L.LayerGroup?e=e._layers:e instanceof L.MarkerCluster?e=e.getAllChildMarkers():e instanceof L.Marker&&(e=[e]):e=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(e),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(e),this},_flagParentsIconsNeedUpdate:function(e){var t,i;for(t in e)for(i=e[t].__parent;i;)i._iconNeedsUpdate=!0,i=i.__parent},_refreshSingleMarkerModeMarkers:function(e){var t,i;for(t in e)i=e[t],this.hasLayer(i)&&i.setIcon(this._overrideMarkerIcon(i))}}),L.Marker.include({refreshIconOptions:function(e,t){var i=this.options.icon;return L.setOptions(i,e),this.setIcon(i),t&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),x.MarkerClusterGroup=c,x.MarkerCluster=p,Object.defineProperty(x,"__esModule",{value:!0})})})(A,A.exports)),A.exports}Nt();const Rt={class:"bg-white rounded-lg shadow p-6 mb-8"},Ht={class:"flex items-center justify-between mb-4"},Vt={class:"text-gray-600"},qt={class:"flex items-center space-x-3"},Wt={class:"text-sm text-gray-500"},Kt={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4"},Qt={__name:"PhotoMap",props:{geoData:{type:Array,required:!0}},setup(v){const f=v,x=k(null);let c=null,p=null,e=[];const t=k(!0),i=k(0),s=()=>{if(!x.value||f.geoData.length===0)return;c&&(c.remove(),c=null);const o=f.geoData.filter(h=>h.lat&&h.lon);if(o.length===0)return;const d=o.reduce((h,_)=>h+_.lat,0)/o.length,l=o.reduce((h,_)=>h+_.lon,0)/o.length;c=j.map(x.value).setView([d,l],8),j.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"Â© OpenStreetMap contributors",maxZoom:19}).addTo(c);const u=j.divIcon({className:"custom-location-marker",html:`
      <div style="position: relative; width: 20px; height: 20px;">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));">
          <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" fill="#EF4444" stroke="#DC2626" stroke-width="0.5"/>
          <circle cx="12" cy="9" r="1.5" fill="white"/>
        </svg>
      </div>
    `,iconSize:[20,20],iconAnchor:[10,20],popupAnchor:[0,-20]});if(p=j.markerClusterGroup({chunkedLoading:!0,chunkInterval:200,chunkDelay:50,maxClusterRadius:60,disableClusteringAtZoom:15,animate:!0,animateAddingMarkers:!0,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,iconCreateFunction:function(h){const _=h.getChildCount();let g="cluster-small";return _<10?g="cluster-small":_<50?g="cluster-medium":g="cluster-large",j.divIcon({html:`
          <div class="custom-cluster-marker ${g}">
            <div class="cluster-inner">
              <span class="cluster-count">${_}</span>
            </div>
          </div>
        `,className:"custom-cluster-container",iconSize:j.point(40,40),iconAnchor:[20,20]})}}),e=[],o.forEach(h=>{const _=j.marker([h.lat,h.lon],{icon:u}),g=`
      <div style="min-width: 200px;">
        <img src="${h.thumbnail}" alt="${h.filename}" style="width: 100%; max-width: 300px; height: auto; border-radius: 4px; margin-bottom: 8px;" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22200%22 height=%22150%22%3E%3Crect fill=%22%23ddd%22 width=%22200%22 height=%22150%22/%3E%3Ctext fill=%22%23999%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dy=%22.3em%22%3ENo thumbnail%3C/text%3E%3C/svg%3E'" />
        <div style="font-weight: 600; margin-bottom: 4px; word-break: break-word;">${h.filename}</div>
        <div style="font-size: 12px; color: #666; margin-bottom: 4px;">By: <a href="https://commons.wikimedia.org/wiki/User:${encodeURIComponent(h.author)}" target="_blank" rel="noopener noreferrer" style="color: #3B82F6; text-decoration: none; font-weight: 500;">${h.author}</a></div>
        <div style="font-size: 12px; color: #666; margin-bottom: 8px;">Date: ${h.date}</div>
        <a href="${h.commonsUrl}" target="_blank" rel="noopener noreferrer" style="display: inline-block; background-color: #3B82F6; color: white; padding: 6px 12px; border-radius: 4px; text-decoration: none; font-size: 12px; font-weight: 500;">View on Commons</a>
      </div>
    `;_.bindPopup(g,{maxWidth:350}),p.addLayer(_),e.push(_)}),t.value?c.addLayer(p):e.forEach(h=>h.addTo(c)),n(),o.length>0){const h=j.latLngBounds(o.map(_=>[_.lat,_.lon]));c.fitBounds(h,{padding:[50,50]})}p&&(p.on("clustermouseover",n),p.on("clusterclick",n),c.on("zoomend",n))},n=()=>{if(p&&t.value){p.eachLayer(d=>{d instanceof j.MarkerCluster});let o=0;c.eachLayer(d=>{d._group===p&&d._icon&&o++}),i.value=o}else i.value=e.length},a=()=>{!c||!p||(t.value=!t.value,t.value?(e.forEach(o=>{c.hasLayer(o)&&c.removeLayer(o)}),c.addLayer(p)):(c.hasLayer(p)&&c.removeLayer(p),e.forEach(o=>o.addTo(c))),n())};return Q(()=>{f.geoData.length>0&&s()}),K(()=>f.geoData,o=>{o.length>0&&s()},{deep:!0}),re(()=>{c&&(c.remove(),c=null),p=null,e=[]}),(o,d)=>(b(),C("div",Rt,[r("div",Ht,[r("div",null,[d[0]||(d[0]=r("h2",{class:"text-xl font-bold text-gray-800 mb-1"},"Photo Locations Map",-1)),r("p",Vt,S(v.geoData.length)+" photos with geolocation data. Click on markers to view photo details. ",1)]),r("div",qt,[r("div",Wt,[d[1]||(d[1]=r("span",{class:"font-medium"},"Clusters:",-1)),W(" "+S(i.value),1)]),r("button",{onClick:a,class:Z(["px-3 py-1 rounded-md text-sm font-medium transition-colors duration-200",t.value?"bg-wikimedia-blue text-white hover:bg-blue-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"])},S(t.value?"Clustering ON":"Clustering OFF"),3)])]),t.value?(b(),C("div",Kt,[...d[2]||(d[2]=[r("div",{class:"flex items-center text-sm text-blue-800"},[r("svg",{class:"w-4 h-4 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),r("span",null," Markers are grouped into clusters. Zoom in or click on clusters to expand them and see individual photos. ")],-1)])])):z("",!0),r("div",{ref_key:"mapContainer",ref:x,class:"h-[500px] w-full rounded-lg border border-gray-300"},null,512)]))}},Xt=X(Qt,[["__scopeId","data-v-9302709c"]]);T.register(...ge);const Yt={id:"daily-uploads",class:"bg-white rounded-lg shadow p-6 mb-8"},Jt={id:"top-users",class:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8"},ei={class:"bg-white rounded-lg shadow p-6"},ti={class:"bg-white rounded-lg shadow p-6"},ii={id:"distribution",class:"bg-white rounded-lg shadow p-6 mb-8"},si={class:"flex justify-center"},oi={class:"w-full max-w-2xl"},ri={id:"file-activity",class:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8"},ni={class:"bg-white rounded-lg shadow p-6"},ai={class:"bg-white rounded-lg shadow p-6"},li={id:"time-activity",class:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8"},di={class:"bg-white rounded-lg shadow p-6"},ui={class:"bg-white rounded-lg shadow p-6"},hi={__name:"DashboardCharts",props:{data:{type:Object,required:!0}},setup(v){const f=v,x=k(null),c=k(null),p=k(null),e=k(null),t=k(null),i=k(null),s=k(null),n=k(null);let a={};const o=()=>{const l=(f.data?.dailyUploads||[]).map(u=>new Date(u.date));return l.length?(l.sort((u,h)=>u-h),{min:l[0],max:l[l.length-1]}):null},d=()=>{Object.values(a).forEach(u=>u.destroy()),a={};const l=o();if(x.value&&f.data.dailyUploads&&(a.daily=new T(x.value,{type:"line",data:{labels:f.data.dailyUploads.map(u=>u.date),datasets:[{label:"Uploads",data:f.data.dailyUploads.map(u=>u.uploads),borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!0}},scales:l?{x:{type:"time",time:{unit:"day"},min:l.min,max:l.max}}:{}}})),c.value&&f.data.userContributions){const u=f.data.userContributions.slice(0,10);a.userBar=new T(c.value,{type:"bar",data:{labels:u.map(h=>h.name),datasets:[{label:"Files",data:u.map(h=>h.files),backgroundColor:"#10B981"}]},options:{responsive:!0,maintainAspectRatio:!0,indexAxis:"y"}})}if(p.value&&f.data.userContributions){const u=f.data.userContributions.slice(0,8);a.userPie=new T(p.value,{type:"pie",data:{labels:u.map(h=>h.name),datasets:[{data:u.map(h=>h.files),backgroundColor:["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D","#FFC658","#FF6B9D"]}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{position:"right"}}}})}if(e.value&&f.data.sizeDistribution&&(a.size=new T(e.value,{type:"bar",data:{labels:f.data.sizeDistribution.map(u=>u.range),datasets:[{label:"Files",data:f.data.sizeDistribution.map(u=>u.count),backgroundColor:"#F59E0B"}]},options:{responsive:!0,maintainAspectRatio:!0}})),i.value&&f.data.dailyUploads){const u=[...f.data.dailyUploads].sort((h,_)=>_.uploads-h.uploads).slice(0,10);a.topDays=new T(i.value,{type:"bar",data:{labels:u.map(h=>h.date),datasets:[{label:"Uploads",data:u.map(h=>h.uploads),backgroundColor:"#EF4444"}]},options:{responsive:!0,maintainAspectRatio:!0,indexAxis:"y"}})}s.value&&f.data.hourlyDistribution&&(a.hourly=new T(s.value,{type:"bar",data:{labels:f.data.hourlyDistribution.map(u=>`${u.hour}:00`),datasets:[{label:"Uploads",data:f.data.hourlyDistribution.map(u=>u.count),backgroundColor:"#8B5CF6"}]},options:{responsive:!0,maintainAspectRatio:!0}})),n.value&&f.data.monthlyActivity&&(a.monthly=new T(n.value,{type:"line",data:{labels:f.data.monthlyActivity.map(u=>u.month),datasets:[{label:"Uploads",data:f.data.monthlyActivity.map(u=>u.count),borderColor:"#06B6D4",backgroundColor:"rgba(6, 182, 212, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!0}})),t.value&&f.data.cameraData&&(a.camera=new T(t.value,{type:"bar",data:{labels:f.data.cameraData.map(u=>u.model),datasets:[{label:"Photos",data:f.data.cameraData.map(u=>u.count),backgroundColor:"#8B5CF6"}]},options:{responsive:!0,maintainAspectRatio:!0,indexAxis:"y"}}))};return Q(()=>{f.data&&d()}),K(()=>f.data,l=>{l&&d()},{deep:!0}),re(()=>{Object.values(a).forEach(l=>l.destroy()),a={}}),(l,u)=>(b(),C("div",null,[r("div",Yt,[u[0]||(u[0]=r("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"Daily Upload Activity",-1)),r("canvas",{ref_key:"dailyChart",ref:x},null,512)]),r("div",Jt,[r("div",ei,[u[1]||(u[1]=r("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"Top Contributors (Files)",-1)),r("canvas",{ref_key:"userBarChart",ref:c},null,512)]),r("div",ti,[u[2]||(u[2]=r("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"Top Camera Models",-1)),r("canvas",{ref_key:"cameraChart",ref:t},null,512)])]),r("div",ii,[u[3]||(u[3]=r("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"Contribution Distribution",-1)),r("div",si,[r("div",oi,[r("canvas",{ref_key:"userPieChart",ref:p},null,512)])])]),r("div",ri,[r("div",ni,[u[4]||(u[4]=r("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"File Size Distribution",-1)),r("canvas",{ref_key:"sizeChart",ref:e},null,512)]),r("div",ai,[u[5]||(u[5]=r("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"Top Upload Days",-1)),r("canvas",{ref_key:"topDaysChart",ref:i},null,512)])]),r("div",li,[r("div",di,[u[6]||(u[6]=r("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"Upload Hours Distribution",-1)),r("canvas",{ref_key:"hourlyChart",ref:s},null,512)]),r("div",ui,[u[7]||(u[7]=r("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"Monthly Activity",-1)),r("canvas",{ref_key:"monthlyChart",ref:n},null,512)])])]))}},ci={class:"bg-white rounded-lg shadow p-6"},fi={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4"},pi={class:"flex items-center gap-3"},mi={class:"overflow-x-auto"},gi={class:"min-w-full divide-y divide-gray-200"},_i={class:"bg-white divide-y divide-gray-200"},vi={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},yi={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},xi=["href","title"],bi={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},wi={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ci={__name:"ContributorsTable",props:{userContributions:{type:Array,required:!0}},setup(v){const f=v,x=k(""),c=k("files"),p=k("desc"),e=()=>{p.value=p.value==="desc"?"asc":"desc"},t=o=>`https://commons.wikimedia.org/wiki/User:${encodeURIComponent(o.trim())}`,i=se(()=>{const o=x.value.toLowerCase();let d=(f.userContributions||[]).filter(h=>!o||(h.name||"").toLowerCase().includes(o));const l=c.value,u=p.value==="desc"?-1:1;return d=d.slice().sort((h,_)=>{let g=h[l],M=_[l];return l==="sizeMB"&&(g=parseFloat(g),M=parseFloat(M)),typeof g=="string"&&(g=g.toLowerCase()),typeof M=="string"&&(M=M.toLowerCase()),g<M?-1*u:g>M?1*u:0}),d}),s=(o,d,l="text/plain")=>{const u=new Blob([d],{type:`${l};charset=utf-8`}),h=URL.createObjectURL(u),_=document.createElement("a");_.href=h,_.download=o,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(h)},n=()=>{const d=[["Rank","Username","Files Uploaded","Total Size (MB)"].join(",")];i.value.forEach((l,u)=>{const h=[u+1,l.name,l.files,l.sizeMB];d.push(h.map(_=>typeof _=="string"&&_.includes(",")?`"${_.replace(/"/g,'""')}"`:_).join(","))}),s("contributors.csv",d.join(`
`),"text/csv")},a=()=>{const o=[];o.push('{| class="wikitable sortable"'),o.push("|+ Contributors"),o.push("! Rank !! Username !! Files Uploaded !! Total Size (MB)"),i.value.forEach((l,u)=>{const h=`[[User:${l.name}|${l.name}]]`;o.push("|-"),o.push(`| ${u+1} || ${h} || ${l.files} || ${l.sizeMB}`)}),o.push("|}");const d=o.join(`
`);navigator.clipboard?.writeText(d).catch(()=>{}),s("contributors-wikitable.txt",d,"text/plain")};return(o,d)=>(b(),C("div",ci,[r("div",fi,[d[4]||(d[4]=r("h2",{class:"text-xl font-bold text-gray-800"},"Detailed User Contributions",-1)),r("div",pi,[H(r("input",{"onUpdate:modelValue":d[0]||(d[0]=l=>x.value=l),type:"search",placeholder:"Search userâ€¦",class:"w-56 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-wikimedia-blue/30 focus:border-wikimedia-blue"},null,512),[[oe,x.value,void 0,{trim:!0}]]),H(r("select",{"onUpdate:modelValue":d[1]||(d[1]=l=>c.value=l),class:"px-3 py-2 text-sm border border-gray-300 rounded-lg"},[...d[2]||(d[2]=[r("option",{value:"files"},"Sort by Files",-1),r("option",{value:"sizeMB"},"Sort by Size",-1),r("option",{value:"name"},"Sort by Name",-1)])],512),[[he,c.value]]),r("button",{onClick:e,class:"px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50"},S(p.value==="desc"?"Desc":"Asc"),1),d[3]||(d[3]=r("div",{class:"h-6 w-px bg-gray-200"},null,-1)),r("button",{onClick:n,class:"px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50"},"Export CSV"),r("button",{onClick:a,class:"px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50"},"Copy Wikitable")])]),r("div",mi,[r("table",gi,[d[5]||(d[5]=r("thead",{class:"bg-gray-50"},[r("tr",null,[r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Rank"),r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Username"),r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Files Uploaded"),r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total Size (MB)")])],-1)),r("tbody",_i,[(b(!0),C(V,null,q(i.value,(l,u)=>(b(),C("tr",{key:l.name,class:"hover:bg-gray-50"},[r("td",vi,S(u+1),1),r("td",yi,[r("a",{href:t(l.name),target:"_blank",rel:"noopener noreferrer",class:"text-wikimedia-blue hover:text-wikimedia-green transition-colors duration-200 font-medium hover:underline",title:`View ${l.name}'s user page on Wikimedia Commons`},S(l.name),9,xi)]),r("td",bi,S(l.files),1),r("td",wi,S(l.sizeMB),1)]))),128))])])])]))}},ki={id:"overview",class:"scroll-mt-20"},Li={id:"map",class:"scroll-mt-20"},Mi={id:"activity",class:"scroll-mt-20"},Si={id:"contributors",class:"scroll-mt-20"},$i={__name:"AnchoredSections",props:{dashboardData:{type:Object,required:!0},stats:{type:Object,required:!0},geoData:{type:Array,required:!0}},setup(v){return(f,x)=>(b(),C("div",null,[r("div",ki,[G(Gt,{stats:v.stats},null,8,["stats"])]),r("div",Li,[v.geoData.length>0?(b(),ne(Xt,{key:0,"geo-data":v.geoData},null,8,["geo-data"])):z("",!0)]),r("div",Mi,[G(hi,{data:v.dashboardData},null,8,["data"])]),r("div",Si,[G(Ci,{"user-contributions":v.dashboardData.userContributions},null,8,["user-contributions"])])]))}},R="/api",Pi="60000";function Bi(){const v=k(!1),f=k(""),x=async(t,i={})=>{const s=new AbortController,n=setTimeout(()=>s.abort(),Pi);try{const a=await fetch(t,{...i,signal:s.signal,headers:{"Content-Type":"application/json",...i.headers}});return clearTimeout(n),a}catch(a){throw clearTimeout(n),a.name==="AbortError"?new Error("Request timeout - server may be unavailable"):a}};return{loading:v,error:f,fetchCategories:async()=>{v.value=!0,f.value="";try{console.log("Fetching categories from:",`${R}/categories.php`);const t=await x(`${R}/categories.php`);if(!t.ok){const s=await t.text();throw new Error(`HTTP ${t.status}: ${t.statusText}${s?` - ${s}`:""}`)}const i=await t.json();if(console.log("Categories response:",i),!i.success)throw new Error(i.error||"API returned success: false");return i.categories||[]}catch(t){const i=`Failed to load categories: ${t.message}`;throw f.value=i,console.error("Categories fetch error:",t),new Error(i)}finally{v.value=!1}},fetchDashboardData:async(t,i=!1)=>{if(!t)throw new Error("Category name is required");v.value=!0,f.value="";try{const s=new URLSearchParams({category:t});i&&s.append("custom","1");const n=`${R}/dashboard.php?${s.toString()}`;console.log("Fetching dashboard data from:",n);const a=await x(n);if(!a.ok){const d=await a.text();throw new Error(`HTTP ${a.status}: ${a.statusText}${d?` - ${d}`:""}`)}const o=await a.json();if(console.log("Dashboard response structure:",{success:o.success,hasRows:Array.isArray(o.rows),rowCount:o.rows?o.rows.length:0,hasData:Array.isArray(o.data),dataCount:o.data?o.data.length:0,hasStatistics:!!o.statistics}),!o.success)throw new Error(o.error||"Failed to fetch dashboard data");return o}catch(s){const n=`Failed to load dashboard data: ${s.message}`;throw f.value=n,console.error("Dashboard fetch error:",s),new Error(n)}finally{v.value=!1}},validateCategory:async t=>{try{const i="https://commons.wikimedia.org/w/api.php";let s=t;s.startsWith("Category:")||(s=`Category:${t}`);const n=new URLSearchParams({action:"query",format:"json",origin:"*",titles:s,prop:"categoryinfo|info",formatversion:"2"}),o=await(await fetch(`${i}?${n}`)).json();if(o.query&&o.query.pages&&o.query.pages.length>0){const d=o.query.pages[0];return{exists:!d.missing,pageCount:d.categoryinfo?d.categoryinfo.pages:0,title:d.title}}return{exists:!1,pageCount:0,title:s}}catch(i){return console.error("Category validation error:",i),{exists:!1,pageCount:0,title:t,error:i.message}}}}}const Oi={key:1,class:"flex-1 bg-gradient-to-br from-blue-50 to-green-50 flex flex-col"},zi={class:"bg-white/90 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-50"},ji={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Ti={class:"flex justify-between items-center h-16"},Ui={class:"flex items-center space-x-4"},Ei={class:"text-xl font-bold text-gray-900"},Ii={class:"text-sm text-gray-500 hidden sm:block"},Di={class:"md:hidden"},Ai={class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Gi={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},Fi={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},Zi={key:0,class:"md:hidden border-t border-gray-200 py-4"},Ni={class:"flex-1 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full"},Ri={__name:"App",setup(v){const{error:f}=Bi(),x=k([]),c=k(null),p=k(null),e=k(null),t=k([]),i=k(!1),s=k(!1);return k(null),k(!1),(n,a)=>(b(),C("div",null,[c.value?(b(),C("div",Oi,[r("header",zi,[r("div",ji,[r("div",Ti,[r("div",Ui,[r("button",{onClick:a[0]||(a[0]=(...o)=>n.backToHome&&n.backToHome(...o)),class:"flex items-center justify-center w-10 h-10 bg-gradient-to-br from-wikimedia-blue to-wikimedia-green rounded-lg hover:shadow-lg transition-all duration-200",title:"Back to Categories"},[...a[2]||(a[2]=[r("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),r("div",null,[r("h1",Ei,S(c.value.displayName),1),r("p",Ii,S(c.value.isCustom?"Custom Category Analytics":"Analytics Dashboard"),1)])]),a[3]||(a[3]=U('<nav class="hidden md:flex items-center space-x-6"><a href="#overview" class="text-gray-700 hover:text-wikimedia-blue font-medium transition-colors duration-200">Overview</a><a href="#map" class="text-gray-700 hover:text-wikimedia-blue font-medium transition-colors duration-200">Map</a><a href="#activity" class="text-gray-700 hover:text-wikimedia-blue font-medium transition-colors duration-200">Activity</a><a href="#contributors" class="text-gray-700 hover:text-wikimedia-blue font-medium transition-colors duration-200">Contributors</a></nav>',1)),r("div",Di,[r("button",{onClick:a[1]||(a[1]=o=>s.value=!s.value),class:"text-gray-700 hover:text-wikimedia-blue p-2"},[(b(),C("svg",Ai,[s.value?(b(),C("path",Fi)):(b(),C("path",Gi))]))])])]),s.value?(b(),C("div",Zi,[...a[4]||(a[4]=[U('<nav class="flex flex-col space-y-2"><a href="#overview" class="text-gray-700 hover:text-wikimedia-blue font-medium py-2 transition-colors duration-200">Overview</a><a href="#map" class="text-gray-700 hover:text-wikimedia-blue font-medium py-2 transition-colors duration-200">Map</a><a href="#activity" class="text-gray-700 hover:text-wikimedia-blue font-medium py-2 transition-colors duration-200">Activity</a><a href="#contributors" class="text-gray-700 hover:text-wikimedia-blue font-medium py-2 transition-colors duration-200">Contributors</a></nav>',1)])])):z("",!0)])]),r("main",Ni,[G($i,{"dashboard-data":p.value,stats:e.value,"geo-data":t.value},null,8,["dashboard-data","stats","geo-data"])])])):(b(),ne(ft,{key:0,categories:x.value,loading:i.value,error:ce(f),onSelect:n.selectCategory,onCustom:n.selectCustomCategory},null,8,["categories","loading","error","onSelect","onCustom"])),G(xt)]))}},Y=fe(Ri);Y.config.errorHandler=(v,f,x)=>{console.error("Global error:",v),console.error("Error info:",x),console.error("Component:",f)};Y.config.warnHandler=(v,f,x)=>{console.warn("Warning:",v),console.warn("Trace:",x)};Y.mount("#app");console.log("Wikimedia Commons Dashboard initialized");console.log("Environment:","production");
